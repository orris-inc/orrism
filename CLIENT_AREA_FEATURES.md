# Client Area Features - å®¢æˆ·ç«¯åŒºåŸŸåŠŸèƒ½

## æ¦‚è¿°

ä¸º ORRISM WHMCS æ¨¡å—åˆ›å»ºäº†å®Œæ•´çš„å®¢æˆ·ç«¯åŒºåŸŸç•Œé¢,æä¾›æµé‡ä¿¡æ¯å±•ç¤ºã€è®¢é˜…é“¾æŽ¥ç®¡ç†å’Œå®¢æˆ·ç«¯ä¸‹è½½å¼•å¯¼ã€‚

## ä¸»è¦åŠŸèƒ½

### 1. è´¦æˆ·ä¿¡æ¯å±•ç¤º âœ…

æ˜¾ç¤ºæœåŠ¡è´¦æˆ·çš„å…³é”®ä¿¡æ¯:
- **UUID**: å”¯ä¸€æ ‡è¯†ç¬¦
- **Account Email**: ç™»å½•é‚®ç®± (ç”¨ä½œç”¨æˆ·å)
- **Status**: æœåŠ¡çŠ¶æ€ (Active/Suspended/Expired)
- **Max Devices**: æœ€å¤§å¹¶å‘è®¾å¤‡æ•°

### 2. æµé‡ä½¿ç”¨ç»Ÿè®¡ âœ…

å®žæ—¶å±•ç¤ºæµé‡ä½¿ç”¨æƒ…å†µ:
- **Total Bandwidth**: æ€»æµé‡é…é¢ (GB)
- **Used**: å·²ä½¿ç”¨æµé‡ (GB)
- **Remaining**: å‰©ä½™æµé‡ (GB)
- **Upload / Download**: ä¸Šä¼ /ä¸‹è½½æµé‡è¯¦æƒ…
- **Usage Progress Bar**: å¯è§†åŒ–è¿›åº¦æ¡
  - æ­£å¸¸: è“ç´«æ¸å˜
  - è­¦å‘Š (75%+): ç²‰çº¢æ¸å˜
  - å±é™© (90%+): çº¢é»„æ¸å˜

### 3. è®¢é˜…é“¾æŽ¥ç®¡ç† âœ…

#### Universal Subscription URL
- é€šç”¨è®¢é˜…é“¾æŽ¥
- ä¸€é”®å¤åˆ¶åŠŸèƒ½
- æ˜¾ç¤ºä¸º monospace å­—ä½“ä¾¿äºŽè¯†åˆ«

#### å®¢æˆ·ç«¯ç‰¹å®šé“¾æŽ¥
æ”¯æŒä¸»æµä»£ç†å®¢æˆ·ç«¯:
- **Clash**: `?client=clash`
- **V2Ray**: `?client=v2ray`
- **Shadowrocket**: `?client=shadowrocket`
- **Surge**: `?client=surge`
- **Quantumult X**: `?client=quantumult`
- **Sing-Box**: `?client=sing-box`

#### QR Code äºŒç»´ç 
- ä½¿ç”¨ QRCode.js ç”Ÿæˆ
- 200x200 åƒç´ 
- é«˜çº é”™çº§åˆ« (H)
- å“ç‰Œé…è‰² (#667eea)
- é€‚åˆç§»åŠ¨ç«¯æ‰«ç å¯¼å…¥

### 4. èŠ‚ç‚¹åˆ—è¡¨å±•ç¤º âœ…

æ˜¾ç¤ºç”¨æˆ·å¯ç”¨çš„æ‰€æœ‰èŠ‚ç‚¹:
- **èŠ‚ç‚¹åç§°**: æ¸…æ™°æ ‡è¯†
- **èŠ‚ç‚¹ç±»åž‹**: Shadowsocks/V2Ray/Trojan ç­‰
- **æœåŠ¡å™¨åœ°å€**: IP:Port
- **åœ¨çº¿çŠ¶æ€**: Online/Offline å¾½ç« 

### 5. å®¢æˆ·ç«¯ä¸‹è½½å¼•å¯¼ âœ…

æä¾›ä¸»æµå¹³å°å®¢æˆ·ç«¯ä¸‹è½½é“¾æŽ¥:

| å¹³å° | æŽ¨èå®¢æˆ·ç«¯ | ä¸‹è½½é“¾æŽ¥ |
|------|-----------|---------|
| Windows | V2RayN | GitHub Releases |
| macOS | ClashX | GitHub Releases |
| Android | V2RayNG | GitHub Releases |
| iOS | Shadowrocket | App Store |

## æ–‡ä»¶ç»“æž„

```
modules/servers/orrism/
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ clientarea.tpl     # å®¢æˆ·ç«¯åŒºåŸŸä¸»æ¨¡æ¿
â”‚   â””â”€â”€ error.tpl           # é”™è¯¯é¡µé¢æ¨¡æ¿
â””â”€â”€ orrism.php              # åŒ…å« orrism_ClientArea() å‡½æ•°
```

## æ¨¡æ¿å˜é‡

### clientarea.tpl æŽ¥æ”¶çš„å˜é‡:

```php
[
    'serviceid' => int,              // WHMCS æœåŠ¡ ID
    'uuid' => string,                // æœåŠ¡ UUID
    'email' => string,               // ç”¨æˆ·é‚®ç®± (ç”¨ä½œç”¨æˆ·å)
    'nodes' => array,                // å¯ç”¨èŠ‚ç‚¹åˆ—è¡¨
    'totalBandwidth' => float,       // æ€»æµé‡ (GB)
    'usedBandwidth' => float,        // å·²ç”¨æµé‡ (GB)
    'remainingBandwidth' => float,   // å‰©ä½™æµé‡ (GB)
    'usagePercent' => float,         // ä½¿ç”¨ç™¾åˆ†æ¯”
    'uploadGB' => float,             // ä¸Šä¼ æµé‡ (GB)
    'downloadGB' => float,           // ä¸‹è½½æµé‡ (GB)
    'subscriptionUrl' => string,     // è®¢é˜…é“¾æŽ¥
    'allowReset' => bool,            // æ˜¯å¦å…è®¸æ‰‹åŠ¨é‡ç½®
    'resetCost' => int,              // é‡ç½®è´¹ç”¨ç™¾åˆ†æ¯”
    'maxDevices' => int,             // æœ€å¤§è®¾å¤‡æ•°
    'status' => string,              // æœåŠ¡çŠ¶æ€
    'lastReset' => string|null       // ä¸Šæ¬¡é‡ç½®æ—¶é—´
]
```

## æ ·å¼è®¾è®¡

### é…è‰²æ–¹æ¡ˆ
- **ä¸»è‰²**: è“ç´«æ¸å˜ (#667eea â†’ #764ba2)
- **æˆåŠŸ**: ç»¿è‰²ç³» (#d4edda)
- **è­¦å‘Š**: é»„è‰²ç³» (#fff3cd)
- **å±é™©**: çº¢è‰²ç³» (#f8d7da)
- **èƒŒæ™¯**: æµ…ç° (#f8f9fa)

### å“åº”å¼è®¾è®¡
- **Desktop**: ç½‘æ ¼å¸ƒå±€ (auto-fit, 200px+)
- **Mobile**: å•åˆ—å¸ƒå±€
- **æ–­ç‚¹**: 768px

### UI ç»„ä»¶
- **Panel**: å¡ç‰‡å¼é¢æ¿,åœ†è§’è¾¹æ¡†
- **Progress Bar**: æ¸å˜è¿›åº¦æ¡,åŠ¨æ€é…è‰²
- **Badge**: çŠ¶æ€å¾½ç«  (Success/Warning/Danger)
- **Button**: æ¸å˜æŒ‰é’®,æ‚¬åœåŠ¨æ•ˆ

## JavaScript åŠŸèƒ½

### 1. å¤åˆ¶åˆ°å‰ªè´´æ¿
```javascript
function copyToClipboard(elementId)
```
- ä¼˜å…ˆä½¿ç”¨çŽ°ä»£ Clipboard API
- å›žé€€åˆ° execCommand å…¼å®¹æ—§æµè§ˆå™¨
- æ˜¾ç¤ºæˆåŠŸ/å¤±è´¥é€šçŸ¥

### 2. é€šçŸ¥ç³»ç»Ÿ
```javascript
function showNotification(message, type = 'success')
```
- å›ºå®šä½ç½®å³ä¸Šè§’
- 3ç§’åŽè‡ªåŠ¨æ·¡å‡º
- æ”¯æŒ success/error ç±»åž‹

### 3. QR Code ç”Ÿæˆ
```javascript
new QRCode(element, options)
```
- ä½¿ç”¨ qrcodejs åº“
- CDN åŠ è½½: jsdelivr.net
- 200x200 åƒç´ ,é«˜çº é”™

## é›†æˆè¯´æ˜Ž

### åŽç«¯å‡½æ•° (orrism.php)

```php
function orrism_ClientArea(array $params)
{
    $db = db();  // OrrisDatabase å®žä¾‹
    $service = $db->getService($serviceid);
    $usage = $db->getServiceUsage($serviceid);
    $nodes = $db->getNodesForGroup($service->node_group_id);

    return [
        'templatefile' => 'clientarea',
        'vars' => [/* ... */]
    ];
}
```

### è®¢é˜…é“¾æŽ¥ç”Ÿæˆ

```php
function generate_subscription_url(array $params, $uuid)
{
    $serverHost = $params['serverhostname'] ?: $params['serverip'];
    $protocol = $params['serversecure'] ? 'https' : 'http';
    return "{$protocol}://{$serverHost}/subscribe/{$uuid}";
}
```

## ç”¨æˆ·ä½“éªŒæµç¨‹

1. **è®¿é—®æœåŠ¡è¯¦æƒ…**
   ```
   WHMCS Client Area > My Services > [ORRISM Service] > View Details
   ```

2. **æŸ¥çœ‹è´¦æˆ·ä¿¡æ¯**
   - UUID å’Œé‚®ç®±ç«‹å³å¯è§
   - çŠ¶æ€å¾½ç« æ¸…æ™°æ ‡è¯†æœåŠ¡çŠ¶æ€

3. **æ£€æŸ¥æµé‡ä½¿ç”¨**
   - è¿›åº¦æ¡ç›´è§‚æ˜¾ç¤ºä½¿ç”¨æ¯”ä¾‹
   - é¢œè‰²å˜åŒ–æé†’æµé‡ä¸è¶³
   - ä¸Šä¼ /ä¸‹è½½åˆ†åˆ«ç»Ÿè®¡

4. **èŽ·å–è®¢é˜…é“¾æŽ¥**
   - å¤åˆ¶é€šç”¨è®¢é˜…é“¾æŽ¥
   - æˆ–é€‰æ‹©ç‰¹å®šå®¢æˆ·ç«¯é“¾æŽ¥
   - æ‰«æ QR ç  (ç§»åŠ¨ç«¯)

5. **ä¸‹è½½å®¢æˆ·ç«¯**
   - æ ¹æ®è®¾å¤‡å¹³å°é€‰æ‹©
   - ç›´æŽ¥è·³è½¬å®˜æ–¹ä¸‹è½½é¡µ

6. **é…ç½®å®¢æˆ·ç«¯**
   - å¯¼å…¥è®¢é˜…é“¾æŽ¥
   - é€‰æ‹©å¯ç”¨èŠ‚ç‚¹
   - å¼€å§‹ä½¿ç”¨

## å®‰å…¨è€ƒè™‘

### 1. æ•°æ®éªŒè¯
- Service ID éªŒè¯
- UUID æ ¼å¼æ£€æŸ¥
- æƒé™æŽ§åˆ¶ (ä»…æ˜¾ç¤ºè‡ªå·±çš„æœåŠ¡)

### 2. æ•æ„Ÿä¿¡æ¯
- ä¸æ˜¾ç¤ºæ˜Žæ–‡å¯†ç 
- UUID å¯å®‰å…¨åˆ†äº«
- è®¢é˜…é“¾æŽ¥åŒ…å«è®¤è¯ä¿¡æ¯

### 3. XSS é˜²æŠ¤
- Smarty æ¨¡æ¿è‡ªåŠ¨è½¬ä¹‰
- ç”¨æˆ·è¾“å…¥è¿‡æ»¤
- URL å‚æ•°éªŒè¯

## æµ‹è¯•æ­¥éª¤

### 1. è®¿é—®å®¢æˆ·ç«¯åŒºåŸŸ
```
Login to WHMCS > Services > [Your ORRISM Service] > Manage
```

### 2. éªŒè¯åŠŸèƒ½
- [ ] è´¦æˆ·ä¿¡æ¯æ­£ç¡®æ˜¾ç¤º
- [ ] æµé‡ç»Ÿè®¡å‡†ç¡®
- [ ] è¿›åº¦æ¡åŠ¨æ€æ›´æ–°
- [ ] è®¢é˜…é“¾æŽ¥å¯å¤åˆ¶
- [ ] QR ç æ­£å¸¸ç”Ÿæˆ
- [ ] èŠ‚ç‚¹åˆ—è¡¨å®Œæ•´
- [ ] å®¢æˆ·ç«¯é“¾æŽ¥å¯è®¿é—®
- [ ] ä¸‹è½½æŒ‰é’®è·³è½¬æ­£ç¡®

### 3. å“åº”å¼æµ‹è¯•
- [ ] Desktop (>1200px)
- [ ] Tablet (768-1200px)
- [ ] Mobile (<768px)

### 4. æµè§ˆå™¨å…¼å®¹
- [ ] Chrome/Edge (Chromium)
- [ ] Firefox
- [ ] Safari
- [ ] Mobile Safari
- [ ] Chrome Mobile

## é¢„æœŸæ•ˆæžœæˆªå›¾è¯´æ˜Ž

### Desktop è§†å›¾
- é¡¶éƒ¨: è´¦æˆ·ä¿¡æ¯ 4 å¡ç‰‡å¸ƒå±€
- ä¸­éƒ¨: æµé‡ç»Ÿè®¡ + è¿›åº¦æ¡
- ä¸‹éƒ¨: è®¢é˜…é“¾æŽ¥ + QR ç 
- åº•éƒ¨: èŠ‚ç‚¹åˆ—è¡¨ + å®¢æˆ·ç«¯ä¸‹è½½

### Mobile è§†å›¾
- å•åˆ—åž‚ç›´å¸ƒå±€
- å¡ç‰‡å…¨å®½æ˜¾ç¤º
- æŒ‰é’®æ‹‰ä¼¸åˆ° 100%
- QR ç å±…ä¸­æ˜¾ç¤º

## æ‰©å±•åŠŸèƒ½å»ºè®®

### çŸ­æœŸå¢žå¼º:
1. **æµé‡é‡ç½®æŒ‰é’®** (å¦‚æžœ allowReset = true)
2. **èŠ‚ç‚¹å»¶è¿Ÿæµ‹è¯•**
3. **ä½¿ç”¨åŽ†å²å›¾è¡¨**
4. **è‡ªå®šä¹‰è®¢é˜…åç§°**

### é•¿æœŸè§„åˆ’:
1. **å¤šè®¢é˜…ç®¡ç†**
2. **è®¾å¤‡ç®¡ç†** (æŸ¥çœ‹/æ’¤é”€è®¾å¤‡)
3. **è§„åˆ™è®¢é˜…** (åˆ†æµè§„åˆ™)
4. **æµé‡é¢„è­¦é€šçŸ¥**
5. **æŽ¨èå¥–åŠ±ç³»ç»Ÿ**

## æ•…éšœæŽ’æŸ¥

### é—®é¢˜ 1: æ¨¡æ¿ä¸æ˜¾ç¤º
**ç—‡çŠ¶**: é¡µé¢ç©ºç™½æˆ–æ˜¾ç¤ºåŽŸå§‹å˜é‡
**åŽŸå› **: æ¨¡æ¿æ–‡ä»¶è·¯å¾„é”™è¯¯
**è§£å†³**:
```bash
# ç¡®è®¤æ¨¡æ¿ç›®å½•å­˜åœ¨
ls -la modules/servers/orrism/templates/

# æ£€æŸ¥æ–‡ä»¶æƒé™
chmod 644 modules/servers/orrism/templates/*.tpl
```

### é—®é¢˜ 2: QR ç ä¸ç”Ÿæˆ
**ç—‡çŠ¶**: QR ç ä½ç½®ç©ºç™½
**åŽŸå› **: CDN åŠ è½½å¤±è´¥æˆ– JS é”™è¯¯
**è§£å†³**:
- æ£€æŸ¥æµè§ˆå™¨æŽ§åˆ¶å°
- éªŒè¯ CDN å¯è®¿é—®æ€§
- ç¡®è®¤ subscriptionUrl å˜é‡å­˜åœ¨

### é—®é¢˜ 3: è®¢é˜…é“¾æŽ¥å¤åˆ¶å¤±è´¥
**ç—‡çŠ¶**: ç‚¹å‡»å¤åˆ¶æŒ‰é’®æ— ååº”
**åŽŸå› **: HTTPS çŽ¯å¢ƒè¦æ±‚æˆ–æµè§ˆå™¨æƒé™
**è§£å†³**:
- ä½¿ç”¨ HTTPS è®¿é—®
- å…è®¸å‰ªè´´æ¿æƒé™
- é™çº§åˆ° fallbackCopy()

### é—®é¢˜ 4: æµé‡æ˜¾ç¤ºä¸º 0
**ç—‡çŠ¶**: æ‰€æœ‰æµé‡æ•°æ®ä¸º 0
**åŽŸå› **: getServiceUsage() è¿”å›žç©ºæ•°æ®
**è§£å†³**:
```php
// æ£€æŸ¥ OrrisDatabase::getServiceUsage()
// ç¡®è®¤ services è¡¨æœ‰æ•°æ®
// éªŒè¯ service_id åŒ¹é…
```

## æ€»ç»“

âœ… **å·²å®ŒæˆåŠŸèƒ½:**
- å®¢æˆ·ç«¯åŒºåŸŸå®Œæ•´ç•Œé¢
- æµé‡ç»Ÿè®¡å’Œå¯è§†åŒ–
- è®¢é˜…é“¾æŽ¥ç®¡ç† (6ç§å®¢æˆ·ç«¯)
- QR ç ç”Ÿæˆ
- èŠ‚ç‚¹åˆ—è¡¨å±•ç¤º
- å®¢æˆ·ç«¯ä¸‹è½½å¼•å¯¼
- å“åº”å¼è®¾è®¡
- å¤åˆ¶/é€šçŸ¥äº¤äº’

ðŸŽ¨ **è®¾è®¡äº®ç‚¹:**
- çŽ°ä»£åŒ–æ¸å˜é…è‰²
- æµç•…çš„åŠ¨ç”»æ•ˆæžœ
- æ¸…æ™°çš„ä¿¡æ¯å±‚çº§
- å‹å¥½çš„ç”¨æˆ·å¼•å¯¼

ðŸ”’ **å®‰å…¨ç‰¹æ€§:**
- æ•°æ®éªŒè¯
- XSS é˜²æŠ¤
- æƒé™æŽ§åˆ¶

ðŸ“± **è®¾å¤‡å…¼å®¹:**
- å…¨å¹³å°å“åº”å¼
- ä¸»æµæµè§ˆå™¨æ”¯æŒ
- ç§»åŠ¨ç«¯ä¼˜åŒ–

çŽ°åœ¨ç”¨æˆ·å¯ä»¥é€šè¿‡ WHMCS å®¢æˆ·ç«¯åŒºåŸŸå®Œæ•´åœ°ç®¡ç†ä»–ä»¬çš„ ORRISM æœåŠ¡! ðŸš€
